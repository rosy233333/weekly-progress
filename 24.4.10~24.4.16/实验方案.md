# 毕设实验方案

时间：2024/4/14

## 任务调度实验

使用 `apps/task/parallel` 测试。该程序会并行地对数组内所有元素求平方根再求和。其会创建多个线程（实验中，可以将其修改为协程），每个线程负责一部分元素的求平方根、汇总。

测试指标：计算需要的时间

比较对象：线程实现和协程实现

实验变量：并发量、CPU核心数

实验表格（每一项测试3次取平均）：

1核心数的情况：

|并发量|8|16|32|64|128|
|-|-|-|-|-|-|
|线程||||||
|协程||||||

2核心数的情况：

|并发量|8|16|32|64|128|
|-|-|-|-|-|-|
|线程||||||
|协程||||||

4核心数的情况：

|并发量|8|16|32|64|128|
|-|-|-|-|-|-|
|线程||||||
|协程||||||

## 网络实验

使用 `apps/net/httpserver` 测试。其会运行一个HTTP服务器，并创建线程来处理连接。

测试指标：服务器响应时间

比较对象：线程实现/协程实现、原情况/专门轮询任务/中断

    原情况/专门轮询任务/中断的说明： `smoltcp` 使用 `poll` 函数来将 Socket 发送缓冲区中的内容传给网卡，将网卡接收缓冲区的内容处理后放入各个 Socket 的接收缓冲区。原情况为：在读写 Socket 前调用 `poll` ，若读 Socket 发现缓冲区空/写 Socket 发现缓冲区满的时候，则 yield，返回后再 `poll`，再读写。专门轮询任务：创建一个任务，定期调用`poll`。中断：在网卡中断到来时，调用`poll`。

实验表格（核心数固定为4，每一项测试5次取平均）：

|测试次数|1|2|3|4|5|
|-|-|-|-|-|-|
|线程+原情况||||||
|线程+轮询||||||
|线程+中断||||||
|协程+原情况||||||
|协程+轮询||||||
|协程+中断||||||

## Redis 实验

使用 `apps/c/redis` 中的 redis 数据库软件进行实验。使用自带的 `redis-benchmark` 命令测试。

测试指标：每秒请求数

比较对象：线程实现/协程实现、原情况/专门轮询任务/中断

实验变量：SET/GET命令、并发量

实验表格（核心数固定为4）：

SET命令：`redis-benchmark -p 5555 -n 100000 -q -t set -c [测试的并发量]`

|并发量|10|20|30|40|50|
|-|-|-|-|-|-|
|线程+原情况||||||
|线程+轮询||||||
|线程+中断||||||
|协程+轮询||||||
|协程+中断||||||

GET命令：`redis-benchmark -p 5555 -n 100000 -q -t get -c [测试的并发量]`

|并发量|10|20|30|40|50|
|-|-|-|-|-|-|
|线程+原情况||||||
|线程+轮询||||||
|线程+中断||||||
|协程+轮询||||||
|协程+中断||||||