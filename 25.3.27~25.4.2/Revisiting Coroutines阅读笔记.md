# 《Revisiting Coroutines》阅读笔记

时间：2025.4.2

## Introduction

协程的概念在1960s被提出。Conway：协程是“饰演主程序的子程序”。

不过，（在当时）许多语言没有提供协程的支持。其原因可以部分地源于对协程没有清晰的定义和统一的视角。Marlin概括的协程的特征：

- 局部变量的值在连续的调用间保持。
- 程序返回视为任务暂停，程序调用视为任务继续。

其描述了协程的行为（保存状态），但不涉及协程的结构。因此可以按照实现方式，对协程进行三种分类：

- 控制流转移方式：对称协程和不对称协程
- 是否在其语言中视为一等对象（First-class Object）（一等对象：可以存入变量，可以作为函数参数和返回值）
- 实现是否有栈，决定了能否从嵌套协程中返回（不过，目前使用async-await语法的无栈协程是可以做到从嵌套协程中返回的。虽然这种嵌套返回的实质也是层层返回到最外层。）

一些适应特定用途的协程：例如生成器、迭代器等。但它们在可表示性（后文定义）上与一般协程不一样。

一等续体（First-class Continuation）：具有明确定义、可以用于实现许多种功能（如生成器、异常处理、backtracing、源代码级多任务、协程）的控制流抽象。但该特性在许多语言中未提供。其导致了协程作为通用控制抽象的研究兴趣近乎终结。

[first-class continuation介绍]("./first-class continuation介绍")

